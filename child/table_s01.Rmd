```{r, results='asis'}
# human-readable condition names
condition_mapping <- data.frame(from=c('4', '6', '12', '20', '24', '48', '72',
                                       'epi', 'trypo'),
                                to=c('Amastigote 4 hpi', 'Amastigote 6 hpi', 
                                        'Amastigote 12 hpi', 'Amastigote 20 hpi',
                                        'Amastigote 24 hpi', 'Amastigote 48 hpi',
                                        'Amastigote 72 hpi', 'Epimastigote',
                                        'Trypomastigote'))
num_reads$condition_long <- condition_mapping$to[match(num_reads$condition, 
                                                       condition_mapping$from)]
table_s01 <- num_reads %>%
    mutate("Infected"=ifelse(condition %in% c('epi', 'trypo'), 'N', 'Y'),
           num_reads_host=replace(num_reads_host, is.na(num_reads_host), 0),
           num_reads_parasite=replace(num_reads_parasite, is.na(num_reads_parasite), 0)) %>%
    mutate(total_mapped=num_reads_host + num_reads_parasite) %>%
    mutate(total_mapped_pct=(total_mapped/num_reads_total) * 100,
           parasite_mapped_pct=(num_reads_parasite/total_mapped) * 100,
           host_mapped_pct=(num_reads_host/total_mapped) * 100) %>%
    select("Lab sample ID"=sample_id,
           "Accession"=accession,
           "Lab sample ID"=sample_id, 
           "Developmental Stage"=condition_long,
           Infected,
           "Batch"=batch,
           "Total number of input reads"=num_reads_total,
           "Total number of reads mapped"=total_mapped,
           "% of total reads mapped"=total_mapped_pct,
           "Reads mapped to T. cruzi Esmeraldo haplotype"=num_reads_parasite,
           "Reads mapped to hg19"=num_reads_host,
           "% of mapped reads belonging to T. cruzi Esmeraldo haplotype"=parasite_mapped_pct,
           "% of mapped reads belonging to hg19"=host_mapped_pct)
xkable(table_s01, digits=3, 
       caption='**Table S1**: Summary of samples collected and mapping statistics')
```
