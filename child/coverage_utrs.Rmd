#### Primary UTR boundaries

```{r table_04, results='asis'}
table_04 <- cbind(c("5'UTR", "3'UTR"), 
            c(sum(utr5_stats$num_reads, na.rm=TRUE), sum(utr3_stats$num_reads, na.rm=TRUE)))
colnames(table_04) <- c("Feature", "Number of reads")

xkable(table_04, caption='**Table 4**: Number of reads supporting the primary UTR boundaries')
```

```{r figure_03, fig.show='hold', out.width='450px', fig.cap="**Figure 3**: Distribution of number of SL- and Poly(A)-containing reads."}
# number of reads containing SL- or Poly(A) sequence
ggplot(data.frame(x=log(utr5_stats_combined$num_reads + 1)), aes(x)) + 
       geom_histogram(binwidth=20, fill=CONFIG$colors[1], colour=CONFIG$stroke, alpha=0.75) +
       labs(x="# SL-containing per site (logged)", y="Frequency") +
       ggtitle('# SL-containing reads')

ggplot(data.frame(x=log(utr3_stats_combined$num_reads + 1)), aes(x)) + 
       geom_histogram(binwidth=20, fill=CONFIG$colors[1], colour=CONFIG$stroke, alpha=0.75) +
       labs(x="# Poly(A)-containing per site (logged)", y="Frequency") +
       ggtitle('# Poly(A)-containing reads')
```

```{r coverage_summary_table, results='asis'}
total_genes <- nrow(utr5_stats_combined)
nvals <- c(1, 2, 3, 4, 5, 10, 100, 1000) 

# % genes with N or more reads mapped to feature
sl_pcts <- c()
polya_pcts <- c()

for (nval in nvals) {
	sl_pcts <- append(sl_pcts, sum(utr5_stats_combined$num_reads >= nval) / total_genes)
}

for (nval in nvals) {
	polya_pcts <- append(polya_pcts, sum(utr3_stats_combined$num_reads >= nval) / total_genes)
}

sl_pcts    <- round(sl_pcts, 4) * 100
polya_pcts <- round(polya_pcts, 4) * 100

# summary data frame
table_05 <- cbind(N=nvals, SL=sl_pcts, PolyA=polya_pcts)

xkable(table_05, caption='**Table 5**: Percent genes containing N or more reads mapping to the specified feature.')
```
