---
title: Trypanosome Gene Structure Analysis (T. cruzi v0.5)
author: Keith Hughitt
output:
  html_document:
    theme: cosmo
    toc: true
    toc_float: true
    number_sections: true
---

Introduction
============

In previous work, *L. major* and *T. cruzi* RNA-Seq data was used to determine
UTR boundaries and splice leader and polyadenylation acceptor 
sites ([1](https://github.com/elsayed-lab/utr_analysis)), and to look for
evidence of alternative trans-splicing and poly-adenylation, and compute basic
statistics relating to SL and Poly(A) site usage 
([2](http://www.umiacs.umd.edu/~keith/research/2015/110-utr-lengths/)) across
on a genome-wide scale.

Here, we expand on these analyses and attempt to map out the gene structure
for each of the parasites, and explore some of the basic properties and features 
of the trypanosome gene structure.

In order to ensure that the results are as easily reproduced as possible, all
relevant figures and tables are shown with the code used to generate them.

In a few instances where it is easier to extract the required information
outside of the R environment (for example, read mapping statistics), external
scripts are provided in the `scripts/` folder.

```{r include=FALSE}
library(knitr)
knit('settings/tcruzi_ystrain.Rmd', quiet=TRUE, output=tempfile())
```

```{r knitr_settings, include=FALSE}
opts_knit$set(progress=FALSE, verbose=TRUE)
opts_chunk$set(fig.width=1080/96,
               fig.height=1080/96,
               dpi=96,
			   echo=CONFIG$verbose)
options(digits=4)
options(stringsAsFactors=FALSE)
options(knitr.duplicate.label='allow')

# If rmarkdown.pandoc.to not specified, have it default to 'latex' output
if (is.null(opts_knit$get("rmarkdown.pandoc.to"))) {
    opts_knit$set(rmarkdown.pandoc.to='latex')
}
```

```{r load_libraries, message=FALSE, warning=FALSE}
library('GenomicRanges')
library('Biostrings')
library('rtracklayer')
library('ggplot2')
library('gridExtra')
library('reshape2')
library('MASS')
library('dplyr')
library('readr')
source('../../../2015/00-shared/R/util.R')
source('child/helper.R')

# fix namespace for dplyr functions
assign('select', dplyr::select, envir=.GlobalEnv)
```

```{r include=FALSE}
knit('child/load_data.Rmd', quiet=TRUE, output=tempfile())
```

Results
=======

Overview
--------

```{r child='child/figure_01.Rmd'}
```

Coverage Statistics
-------------------

```{r child='child/table_01.Rmd'}
```

```{r child='child/table_s01.Rmd'}
```

CDS/UTRs
--------

```{r child='child/rnaseq_coverage.Rmd'}
```

```{r child='child/length_summary.Rmd'}
```

```{r child='child/length_correlations.Rmd'}
```

Intergenic Regions
------------------

- **Note**: temporarily skipping to speed up development; will re-enable
     later.
<!--
``{r child='child/intergenic_regions.Rmd'}
``
-->

Alternative trans-splicing and polyadenylation
----------------------------------------------

```{r child='child/figure_03c-e.Rmd'}
```

```{r child='child/figure_04a.Rmd'}
```

Mapping statistics
------------------

```{r child='child/mapping_statistics.Rmd'}
```

System Info
===========

```{r}
sessionInfo()
```

